package com.innodealing.dao.jdbc.dm.bond.ccxe;

import java.util.Date;
import java.util.List;

import org.springframework.jdbc.core.BeanPropertyRowMapper;
import org.springframework.jdbc.core.RowMapper;
import org.springframework.stereotype.Component;

import com.innodealing.dao.jdbc.BaseDao;
import com.innodealing.model.dm.bond.asbrs.BondInsuFinaSheet;
import com.innodealing.util.DateUtils;

/**
 * @author kunkun.zhou
 * @date 2016年12月07日
 * @clasename BondInsuFinaSheetDao.java
 * @decription TODO
 */
@Component
public class BondTargetInsuFinaDao extends BaseDao<BondInsuFinaSheet> {
	private RowMapper rowMapper = new BeanPropertyRowMapper(BondInsuFinaSheet.class);
	
	public BondInsuFinaSheet getTargetData(Long comUniCode, Long bondUniCode, Date endDate) {
		String selResult = "a.TAFBBY_110101 as IBS101, "
				+ "a.TAFBBY_110401 as IBS102, "
				+ "a.TAFBBY_110501 as IBS103, "
				+ "a.TAFBBY_110701 as IBS104, "
				+ "a.TAFBBY_110801 as IBS105, "
				+ "a.TAFBBF_111601 as IBS107, "
				+ "a.TAFBBF_111701 as IBS108, "
				+ "a.TAFBBF_111801 as IBS109, "
				+ "a.TAFBBY_111701 as IBS106, "
				+ "a.TAFBBF_112001 as IBS110, "
				+ "a.TAFBBF_112101 as IBS111, "
				+ "a.TAFBBF_112201 as IBS112, "
				+ "a.TAFBBF_112301 as IBS113, "
				+ "a.TAFBBF_110501 as IBS114, "
				+ "a.TAFBBF_113701 as IBS127, "
				+ "a.TAFBBF_113901 as IBS115, "
				+ "a.TAFBBY_121601 as IBS116, "
				+ "a.TAFBBY_121901 as IBS120, "
				+ "a.TAFBBY_121117 as IBS118, "
				+ "a.TAFBBY_123401 as IBS119, "
				+ "a.TAFBBY_122327 as IBS121, "
				+ "a.TAFBBY_122427 as IBS128, "
				+ "a.TAFBBY_122801 as IBS122, "
				+ "a.TAFBBY_123701 as IBS124, "
				+ "a.TAFBBY_123201 as IBS129, "
				+ "a.TAFBBY_130000 as IBS125, "
				+ "a.TAFBBY_123302 as IBS123, "
				+ "a.TAFBB_100000 as IBS001, "
				+ "a.TAFBBY_210201 as IBS201, "
				+ "a.TAFBBY_210301 as IBS202, "
				+ "a.TAFBBY_210501 as IBS203, "
				+ "a.TAFBBY_210601 as IBS204, "
				+ "a.TAFBBY_210701 as IBS205, "
				+ "a.TAFBBF_213201 as IBS206, "
				+ "a.TAFBBF_213301 as IBS207, "
				+ "a.TAFBBF_213401 as IBS208, "
				+ "a.TAFBBY_213201 as IBS209, "
				+ "a.TAFBBY_213401 as IBS210, "
				+ "a.TAFBBY_211901 as IBS223, "
				+ "a.TAFBBF_214301 as IBS211, "
				+ "a.TAFBBF_214401 as IBS212, "
				+ "a.TAFBBY_213601 as IBS224, "
				+ "a.TAFBBF_220501 as IBS213, "
				+ "a.TAFBBF_214501 as IBS214, "
				+ "a.TAFBBF_214601 as IBS215, "
				+ "a.TAFBBF_220101 as IBS216, "
				+ "a.TAFBBF_220201 as IBS217, "
				+ "a.TAFBBY_220601 as IBS218, "
				+ "a.TAFBBY_220801 as IBS219, "
				+ "a.TAFBBY_230101 as IBS221, "
				+ "a.TAFBBY_240101 as IBS222, "
				+ "a.TAFBBY_220702 as IBS220, "
				+ "a.TAFBB_210000 as IBS002, "
				+ "a.TAFBBY_310201 as IBS301, "
				+ "a.TAFBBY_310301 as IBS302, "
				+ "a.TAFBBY_310703 as IBS302_2, "
				+ "a.TAFBBY_310401 as IBS303, "
				+ "a.TAFBBY_310601 as IBS304, "
				+ "a.TAFBBY_310701 as IBS305, "
				+ "a.TAFBBY_310801 as IBS308, "
				+ "a.TAFBBY_311201 as IBS306, "
				+ "a.TAFBBY_310101 as IBS309, "
				+ "a.TAFBBY_300000 as IBS003, "
				+ "a.TAFBBY_400000 as IBS004, "
				+ "b.TAFPBY_100000 as IPL100, "
				+ "b.TAFPBF_110201 as IPL101, "
				+ "b.TAFPBF_110213 as IPL102, "
				+ "b.TAFPBF_110215 as IPL102_1,"
				+ "b.TAFPBF_110224 as IPL102_2,"
				+ "b.TAFPBF_110301 as IPL103,"
				+ "b.TAFPBY_110701 as IPL104,"
				+ "b.TAFPBY_110711 as IPL104_1,"
				+ "b.TAFPBY_110801 as IPL105,"
				+ "b.TAFPBY_111101 as IPL106,"
				+ "b.TAFPBY_111201 as IPL107,"
				+ "b.TAFPBY_200000 as IPL200,"
				+ "b.TAFPBF_200603 as IPL201,"
				+ "b.TAFPBF_200203 as IPL202,"
				+ "b.TAFPBF_200213 as IPL202_1,"
				+ "b.TAFPBF_200403 as IPL203,"
				+ "b.TAFPBF_200413 as IPL203_1,"
				+ "b.TAFPBF_200703 as IPL204,"
				+ "b.TAFPBF_200503 as IPL205,"
				+ "b.TAFPBF_201903 as IPL206,"
				+ "b.TAFPBF_200504 as IPL207,"
				+ "b.TAFPBF_200903 as IPL208,"
				+ "b.TAFPBF_200913 as IPL208_1,"
				+ "b.TAFPBF_201803 as IPL210,"
				+ "b.TAFPBF_201703 as IPL209,"
				+ "b.TAFPBY_300000 as IPL300,"
				+ "b.TAFPBY_310101 as IPL301,"
				+ "b.TAFPBY_310203 as IPL302,"
				+ "b.TAFPBY_400000 as IPL400,"
				+ "b.TAFPBY_410203 as IPL401,"
				+ "b.TAFPBY_500000 as IPL500,"
				+ "b.TAFPBY_510101 as IPL501,"
				+ "b.TAFPBY_510201 as IPL502,"
				+ "b.TAFPB_240801 as IPL503,"
				+ "b.TAFPB_240901 as IPL504,"
				+ "b.TAFPBY_510301 as IPL505,"
				+ "b.TAFPB_I_170101 as IPL506,"
				+ "b.TAFPB_170102 as IPL507,"
				+ "b.TAFPB_170103 as IPL508,"
				+ "c.TAFCBY_110001 as ICF101,"
				+ "c.TAFCBY_110007 as ICF102,"
				+ "c.TAFCBF_110014 as ICF103,"
				+ "c.TAFCBF_110015 as ICF104,"
				+ "c.TAFCBF_110016 as ICF105,"
				+ "c.TAFCBY_110009 as ICF106,"
				+ "c.TAFCBY_110401 as ICF108,"
				+ "c.TAFCBY_110000 as ICF100,"
				+ "c.TAFCBY_120001 as ICF201,"
				+ "c.TAFCBY_120045 as ICF202,"
				+ "c.TAFCBF_120025 as ICF203,"
				+ "c.TAFCBY_120002 as ICF204,"
				+ "c.TAFCBF_120026 as ICF205,"
				+ "c.TAFCBY_120301 as ICF206,"
				+ "c.TAFCBY_120401 as ICF207,"
				+ "c.TAFCBY_120501 as ICF208,"
				+ "c.TAFCBY_120000 as ICF200,"
				+ "c.TAFCBY_100000 as ICF001,"
				+ "c.TAFCBY_210101 as ICF301,"
				+ "c.TAFCBY_210201 as ICF302,"
				+ "c.TAFCBY_210301 as ICF303,"
				+ "c.TAFCBY_210501 as ICF304,"
				+ "c.TAFCBY_210401 as ICF305,"
				+ "c.TAFCBY_210000 as ICF300,"
				+ "c.TAFCBY_220101 as ICF401,"
				+ "c.TAFCBY_220201 as ICF402,"
				+ "c.TAFCBY_220402 as ICF403,"
				+ "c.TAFCBY_220401 as ICF404,"
				+ "c.TAFCBY_220301 as ICF405,"
				+ "c.TAFCBY_220000 as ICF400,"
				+ "c.TAFCBY_200000 as ICF002,"
				+ "c.TAFCBY_310301 as ICF501,"
				+ "c.TAFCBY_310111 as ICF502,"
				+ "c.TAFCBY_310401 as ICF503,"
				+ "c.TAFCBY_310201 as ICF504,"
				+ "c.TAFCBY_310501 as ICF505,"
				+ "c.TAFCBY_310000 as ICF500,"
				+ "c.TAFCBY_320101 as ICF601,"
				+ "c.TAFCBY_320301 as ICF602,"
				+ "c.TAFCBY_320801 as ICF603,"
				+ "c.TAFCBY_320701 as ICF604,"
				+ "c.TAFCBY_320000 as ICF600,"
				+ "c.TAFCBY_300000 as ICF003,"
				+ "c.TAFCBY_410101 as ICF701,"
				+ "c.TAFCBY_410201 as ICF004,"
				+ "c.TAFCBY_413201 as ICF801,"
				+ "c.TAFCBY_413301 as ICF005,"
				+ "c.TAFCBY_411001 as ICF901,"
				+ "c.TAFCBY_411401 as ICF902,"
				+ "c.TAFCBY_411501 as ICF903,"
				+ "c.TAFCBY_411601 as ICF904,"
				+ "c.TAFCBY_411701 as ICF905,"
				+ "c.TAFCBY_411801 as ICF906,"
				
				+ "c.TAFCBY_411901 as ICF907,"
				+ "c.TAFCBY_412001 as ICF908,"
				+ "c.TAFCBY_412101 as ICF909,"
				+ "c.TAFCBY_413501 as ICF910,"
				+ "c.TAFCBY_412201 as ICF911,"
				+ "c.TAFCBY_412301 as ICF912,"
				+ "c.TAFCBY_413601 as ICF913,"
				+ "c.TAFCBY_413701 as ICF914,"
				+ "c.TAFCBY_412601 as ICF915,"
				+ "c.TAFCBY_412701 as ICF916,"
				+ "c.TAFCBY_412801 as ICF917,"
				+ "c.TAFCBY_413001 as ICF918,"
				+ "c.TAFCBY_ADD_OPER_NETCASH as ICF919,"
				+ "c.TAFCBY_410501 as ICF920,"
				+ "c.TAFCBY_410801 as ICF921,"
				+ "c.TAFCBY_410802 as ICF922,"
				+ "c.TAFCBY_510101 as ICF923,"
				+ "c.TAFCBY_510201 as ICF924,"
				+ "c.TAFCBY_510301 as ICF925,"
				+ "c.TAFCBY_510401 as ICF926,"
				+ "c.TAFCBY_ADD_NETCASH as ICF927";
		
		String sql = "select a.COM_UNI_CODE,a.END_DATE,"+selResult
		+ " from D_BOND_FIN_FAL_BALA_TAFBB a "
		+ " inner join D_BOND_FIN_FAL_PROF_TAFPB b on b.COM_UNI_CODE=a.COM_UNI_CODE and b.END_DATE=a.END_DATE and b.ISVALID=a.ISVALID and b.SHEET_MARK_PAR=a.SHEET_MARK_PAR "
		+ " left join D_BOND_FIN_FAL_CASH_TAFCB c on c.COM_UNI_CODE=a.COM_UNI_CODE and c.END_DATE=a.END_DATE and c.ISVALID=a.ISVALID and c.SHEET_MARK_PAR=a.SHEET_MARK_PAR "
		+ " where a.ISVALID='1' and a.SHEET_MARK_PAR='1' and a.COM_UNI_CODE=" + comUniCode + " and a.bond_uni_code=" + bondUniCode + " and a.END_DATE='" + DateUtils.convertDateToString(endDate) + "' limit 1";
		
		List<BondInsuFinaSheet> list = ccxeJdbcTemplate.query(sql.toString(), rowMapper);
		if (null == list || list.isEmpty()) {
			return null;
		}
		return list.get(0);
	}
	
	public List<BondInsuFinaSheet> getList(Integer start, Integer length) {
		String selResult = "a.TAFBBY_110101 as IBS101, "
				+ "a.TAFBBY_110401 as IBS102, "
				+ "a.TAFBBY_110501 as IBS103, "
				+ "a.TAFBBY_110701 as IBS104, "
				+ "a.TAFBBY_110801 as IBS105, "
				+ "a.TAFBBF_111601 as IBS107, "
				+ "a.TAFBBF_111701 as IBS108, "
				+ "a.TAFBBF_111801 as IBS109, "
				+ "a.TAFBBY_111701 as IBS106, "
				+ "a.TAFBBF_112001 as IBS110, "
				+ "a.TAFBBF_112101 as IBS111, "
				+ "a.TAFBBF_112201 as IBS112, "
				+ "a.TAFBBF_112301 as IBS113, "
				+ "a.TAFBBF_110501 as IBS114, "
				+ "a.TAFBBF_113701 as IBS127, "
				+ "a.TAFBBF_113901 as IBS115, "
				+ "a.TAFBBY_121601 as IBS116, "
				+ "a.TAFBBY_121901 as IBS120, "
				+ "a.TAFBBY_121117 as IBS118, "
				+ "a.TAFBBY_123401 as IBS119, "
				+ "a.TAFBBY_122327 as IBS121, "
				+ "a.TAFBBY_122427 as IBS128, "
				+ "a.TAFBBY_122801 as IBS122, "
				+ "a.TAFBBY_123701 as IBS124, "
				+ "a.TAFBBY_123201 as IBS129, "
				+ "a.TAFBBY_130000 as IBS125, "
				+ "a.TAFBBY_123302 as IBS123, "
				+ "a.TAFBB_100000 as IBS001, "
				+ "a.TAFBBY_210201 as IBS201, "
				+ "a.TAFBBY_210301 as IBS202, "
				+ "a.TAFBBY_210501 as IBS203, "
				+ "a.TAFBBY_210601 as IBS204, "
				+ "a.TAFBBY_210701 as IBS205, "
				+ "a.TAFBBF_213201 as IBS206, "
				+ "a.TAFBBF_213301 as IBS207, "
				+ "a.TAFBBF_213401 as IBS208, "
				+ "a.TAFBBY_213201 as IBS209, "
				+ "a.TAFBBY_213401 as IBS210, "
				+ "a.TAFBBY_211901 as IBS223, "
				+ "a.TAFBBF_214301 as IBS211, "
				+ "a.TAFBBF_214401 as IBS212, "
				+ "a.TAFBBY_213601 as IBS224, "
				+ "a.TAFBBF_220501 as IBS213, "
				+ "a.TAFBBF_214501 as IBS214, "
				+ "a.TAFBBF_214601 as IBS215, "
				+ "a.TAFBBF_220101 as IBS216, "
				+ "a.TAFBBF_220201 as IBS217, "
				+ "a.TAFBBY_220601 as IBS218, "
				+ "a.TAFBBY_220801 as IBS219, "
				+ "a.TAFBBY_230101 as IBS221, "
				+ "a.TAFBBY_240101 as IBS222, "
				+ "a.TAFBBY_220702 as IBS220, "
				+ "a.TAFBB_210000 as IBS002, "
				+ "a.TAFBBY_310201 as IBS301, "
				+ "a.TAFBBY_310301 as IBS302, "
				+ "a.TAFBBY_310703 as IBS302_2, "
				+ "a.TAFBBY_310401 as IBS303, "
				+ "a.TAFBBY_310601 as IBS304, "
				+ "a.TAFBBY_310701 as IBS305, "
				+ "a.TAFBBY_310801 as IBS308, "
				+ "a.TAFBBY_311201 as IBS306, "
				+ "a.TAFBBY_310101 as IBS309, "
				+ "a.TAFBBY_300000 as IBS003, "
				+ "a.TAFBBY_400000 as IBS004, "
				+ "b.TAFPBY_100000 as IPL100, "
				+ "b.TAFPBF_110201 as IPL101, "
				+ "b.TAFPBF_110213 as IPL102, "
				+ "b.TAFPBF_110215 as IPL102_1,"
				+ "b.TAFPBF_110224 as IPL102_2,"
				+ "b.TAFPBF_110301 as IPL103,"
				+ "b.TAFPBY_110701 as IPL104,"
				+ "b.TAFPBY_110711 as IPL104_1,"
				+ "b.TAFPBY_110801 as IPL105,"
				+ "b.TAFPBY_111101 as IPL106,"
				+ "b.TAFPBY_111201 as IPL107,"
				+ "b.TAFPBY_200000 as IPL200,"
				+ "b.TAFPBF_200603 as IPL201,"
				+ "b.TAFPBF_200203 as IPL202,"
				+ "b.TAFPBF_200213 as IPL202_1,"
				+ "b.TAFPBF_200403 as IPL203,"
				+ "b.TAFPBF_200413 as IPL203_1,"
				+ "b.TAFPBF_200703 as IPL204,"
				+ "b.TAFPBF_200503 as IPL205,"
				+ "b.TAFPBF_201903 as IPL206,"
				+ "b.TAFPBF_200504 as IPL207,"
				+ "b.TAFPBF_200903 as IPL208,"
				+ "b.TAFPBF_200913 as IPL208_1,"
				+ "b.TAFPBF_201803 as IPL210,"
				+ "b.TAFPBF_201703 as IPL209,"
				+ "b.TAFPBY_300000 as IPL300,"
				+ "b.TAFPBY_310101 as IPL301,"
				+ "b.TAFPBY_310203 as IPL302,"
				+ "b.TAFPBY_400000 as IPL400,"
				+ "b.TAFPBY_410203 as IPL401,"
				+ "b.TAFPBY_500000 as IPL500,"
				+ "b.TAFPBY_510101 as IPL501,"
				+ "b.TAFPBY_510201 as IPL502,"
				+ "b.TAFPB_240801 as IPL503,"
				+ "b.TAFPB_240901 as IPL504,"
				+ "b.TAFPBY_510301 as IPL505,"
				+ "b.TAFPB_I_170101 as IPL506,"
				+ "b.TAFPB_170102 as IPL507,"
				+ "b.TAFPB_170103 as IPL508,"
				+ "c.TAFCBY_110001 as ICF101,"
				+ "c.TAFCBY_110007 as ICF102,"
				+ "c.TAFCBF_110014 as ICF103,"
				+ "c.TAFCBF_110015 as ICF104,"
				+ "c.TAFCBF_110016 as ICF105,"
				+ "c.TAFCBY_110009 as ICF106,"
				+ "c.TAFCBY_110401 as ICF108,"
				+ "c.TAFCBY_110000 as ICF100,"
				+ "c.TAFCBY_120001 as ICF201,"
				+ "c.TAFCBY_120045 as ICF202,"
				+ "c.TAFCBF_120025 as ICF203,"
				+ "c.TAFCBY_120002 as ICF204,"
				+ "c.TAFCBF_120026 as ICF205,"
				+ "c.TAFCBY_120301 as ICF206,"
				+ "c.TAFCBY_120401 as ICF207,"
				+ "c.TAFCBY_120501 as ICF208,"
				+ "c.TAFCBY_120000 as ICF200,"
				+ "c.TAFCBY_100000 as ICF001,"
				+ "c.TAFCBY_210101 as ICF301,"
				+ "c.TAFCBY_210201 as ICF302,"
				+ "c.TAFCBY_210301 as ICF303,"
				+ "c.TAFCBY_210501 as ICF304,"
				+ "c.TAFCBY_210401 as ICF305,"
				+ "c.TAFCBY_210000 as ICF300,"
				+ "c.TAFCBY_220101 as ICF401,"
				+ "c.TAFCBY_220201 as ICF402,"
				+ "c.TAFCBY_220402 as ICF403,"
				+ "c.TAFCBY_220401 as ICF404,"
				+ "c.TAFCBY_220301 as ICF405,"
				+ "c.TAFCBY_220000 as ICF400,"
				+ "c.TAFCBY_200000 as ICF002,"
				+ "c.TAFCBY_310301 as ICF501,"
				+ "c.TAFCBY_310111 as ICF502,"
				+ "c.TAFCBY_310401 as ICF503,"
				+ "c.TAFCBY_310201 as ICF504,"
				+ "c.TAFCBY_310501 as ICF505,"
				+ "c.TAFCBY_310000 as ICF500,"
				+ "c.TAFCBY_320101 as ICF601,"
				+ "c.TAFCBY_320301 as ICF602,"
				+ "c.TAFCBY_320801 as ICF603,"
				+ "c.TAFCBY_320701 as ICF604,"
				+ "c.TAFCBY_320000 as ICF600,"
				+ "c.TAFCBY_300000 as ICF003,"
				+ "c.TAFCBY_410101 as ICF701,"
				+ "c.TAFCBY_410201 as ICF004,"
				+ "c.TAFCBY_413201 as ICF801,"
				+ "c.TAFCBY_413301 as ICF005,"
				+ "c.TAFCBY_411001 as ICF901,"
				+ "c.TAFCBY_411401 as ICF902,"
				+ "c.TAFCBY_411501 as ICF903,"
				+ "c.TAFCBY_411601 as ICF904,"
				+ "c.TAFCBY_411701 as ICF905,"
				+ "c.TAFCBY_411801 as ICF906,"
				
				+ "c.TAFCBY_411901 as ICF907,"
				+ "c.TAFCBY_412001 as ICF908,"
				+ "c.TAFCBY_412101 as ICF909,"
				+ "c.TAFCBY_413501 as ICF910,"
				+ "c.TAFCBY_412201 as ICF911,"
				+ "c.TAFCBY_412301 as ICF912,"
				+ "c.TAFCBY_413601 as ICF913,"
				+ "c.TAFCBY_413701 as ICF914,"
				+ "c.TAFCBY_412601 as ICF915,"
				+ "c.TAFCBY_412701 as ICF916,"
				+ "c.TAFCBY_412801 as ICF917,"
				+ "c.TAFCBY_413001 as ICF918,"
				+ "c.TAFCBY_ADD_OPER_NETCASH as ICF919,"
				+ "c.TAFCBY_410501 as ICF920,"
				+ "c.TAFCBY_410801 as ICF921,"
				+ "c.TAFCBY_410802 as ICF922,"
				+ "c.TAFCBY_510101 as ICF923,"
				+ "c.TAFCBY_510201 as ICF924,"
				+ "c.TAFCBY_510301 as ICF925,"
				+ "c.TAFCBY_510401 as ICF926,"
				+ "c.TAFCBY_ADD_NETCASH as ICF927";
		
		String sql = "select a.COM_UNI_CODE,a.END_DATE,"+selResult
		+ " from TMP_BOND_FIN_FAL_BALA_TAFBB a "
		+ " inner join TMP_BOND_FIN_FAL_PROF_TAFPB b on b.COM_UNI_CODE=a.COM_UNI_CODE and b.END_DATE=a.END_DATE "
		+ " left join TMP_BOND_FIN_FAL_CASH_TAFCB c on c.COM_UNI_CODE=a.COM_UNI_CODE and c.END_DATE=a.END_DATE "
		+ " order by a.com_uni_code,a.end_date limit "+start+"," + length;
				
		return ccxeJdbcTemplate.query(sql, rowMapper);
	}

	public Integer getAllCount() {
		StringBuilder sql = new StringBuilder();
		sql.append(" select count(1) from TMP_BOND_FIN_FAL_BALA_TAFBB a ")
		.append(" inner join TMP_BOND_FIN_FAL_PROF_TAFPB b on b.COM_UNI_CODE=a.COM_UNI_CODE and b.END_DATE=a.END_DATE ")
		.append(" left join TMP_BOND_FIN_FAL_CASH_TAFCB c on c.COM_UNI_CODE=a.COM_UNI_CODE and c.END_DATE=a.END_DATE ");
		return ccxeJdbcTemplate.queryForObject(sql.toString(), Integer.class);
	}
}
